filter(larvalEmergence=="1")
summary(colony_ideal)
######################## number collected each date ################################
ndate<- prattvilleparasitism %>%
filter(Date!= "6/29/2021") %>%
group_by(Date) %>%
summarise('Number Collected' =n())
ndate
ggtexttable(ndate, rows = NULL, theme = ttheme("classic"))
########################### sex data #################################################
#### eggs laid ~ sex ####
ggplot(prattvilleparasitism %>% filter(Sex!="nymph" & eggs=="y" & eggNumber<20), aes(x=Sex, color=Sex, y=eggNumber))+
geom_point(position = "jitter")+
theme(text=element_text(size=15))+
scale_color_brewer(palette = "Set2")+
labs(title = "Proportion of Eggs Laid on Host by Host Sex and Mating Pair")+
xlab('Sex of Host')+
ylab('Egg Number Laid on Host')+
scale_x_discrete(labels=c("Male", "Female"))+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",
size = 0.75))+
facet_wrap(~matingpair, labeller="label_both")+
geom_smooth(method="lm")
ggplot() +
geom_pointrange(data=eggnum_sex_em, aes(y=emmean, x=Sex, ymin=lower.CL, ymax=upper.CL, color=matingpair), size=2, position="jitter")+
theme(text=element_text(size=15))+
scale_color_brewer(palette = "Set2")+
labs(title = "Eggs Laid on Hosts",
subtitle = "by Sex and Mating Pair")+
xlab('Sex of Host')+
ylab('Mean Egg Number Laid on Host')+
scale_x_discrete(labels=c("Male", "Female"))+
scale_fill_manual(name="Mating Pair",labels=c("Yes", "No"), values=c("aquamarine3","coral"))+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",size = 0.75),
legend.position = c(.8,.8))
ggplot(emergence_noNA%>% filter(Sex!="nymph"), aes(fill=Sex, x=larvalEmergence))+
geom_histogram(stat="count", position="dodge") +
theme(text=element_text(size=15))+
scale_fill_brewer(palette = "Set2")+
labs(title = "Emergence of Parasitoid by Sex of Host")+
xlab('Parasitoid Emergence')+
ylab('Count')+
scale_x_discrete(labels=c("Yes", "No"))+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",
size = 0.75),
legend.position = c(.1,.8))
ggplot(clean_pupationlength, aes(x=daysPupationToAdult, fill=daysPupationToAdult))+
geom_histogram(stat="count", position="dodge")+
theme(text=element_text(size=15))+
scale_fill_brewer(palette = "Set2")#histogram of pupation length
ggplot(clean_death, aes(x=larvalEmergence, y=daystoDeath, fill=larvalEmergence))+
geom_boxplot()+
theme(text=element_text(size=15))+
scale_fill_brewer(palette = "Set2")+
scale_x_discrete(labels=c("Produced a Parasitoid", "Did not Produce a Parasitoid"))+
labs(x=" ",
y="Days until Death",
title = "Days to death and Parasitoid Emergence")
ggplot(clean_death %>% filter(eggNumber<20 & eggNumber>0 & daystoDeath<100),
aes(y=eggNumber, x=daystoDeath, color=larvalEmergence))+
geom_point(size=3, alpha=.7, position = "jitter")+
theme(text=element_text(size=15))+
geom_smooth(method="lm", se=FALSE)+
labs(y="Number of Eggs on Host",
x="Days until Death",
title = "Days until Death in Parasitized Bugs",
subtitle = "by Number of Eggs laid on Host")+
scale_color_manual(name="Produced a Parasitoid", labels=c("Yes","No"),
values = c("aquamarine3","coral"))+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",
size = 0.75),
legend.position = c(.5,.8),
axis.text.x = element_text(size = 16),
axis.title.y = element_text(size=16),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black"),
strip.background = element_blank(),
strip.text = element_blank())+
scale_y_continuous(breaks=seq(0, 12, 2))+
coord_cartesian(ylim=c(0,12))+
facet_wrap(~larvalEmergence)
ggplot(clean_death %>% filter(eggNumber<20 & eggNumber>0 & daystoDeath<100),
aes(y=eggNumber, x=daystoDeath, color=larvalEmergence))+
geom_point(size=3, alpha=.7, position = "jitter")+
theme(text=element_text(size=15))+
geom_smooth(method="lm", se=FALSE)+
labs(y="Number of Eggs on Host",
x="Days until Death",
title = "Days until Death in Parasitized Bugs",
subtitle = "by Number of Eggs laid on Host")+
scale_color_manual(name="Produced a Parasitoid", labels=c("Yes","No"),
values = c("aquamarine3","coral"))+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",
size = 0.75),
legend.position = c(.8,.8),
axis.text.x = element_text(size = 16),
axis.title.y = element_text(size=16),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black"),
strip.background = element_blank(),
strip.text = element_blank())+
scale_y_continuous(breaks=seq(0, 12, 2))+
coord_cartesian(ylim=c(0,12))
ggplot(avg_death_para, aes(x=larvalEmergence, y=days_dead, fill=eggs))+
geom_col(position = "dodge")+
theme(text=element_text(size=15))+
#scale_fill_brewer(palette = "Set2")+
labs(title = "Average Days to Death",
subtitle = "for Stink Bugs With or Without Evidence of Parasitism")+
xlab(' ')+
ylab('Days to Death')+
scale_x_discrete(labels=c("Produced a Parasitoid", "Did not Produce a Parasitoid"))+
scale_fill_manual(name="Bearing Parasitoid Eggs",labels=c("Yes", "No"), values=c("aquamarine3","coral"))+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",
size = 0.75),
legend.position = c(.25,.8),
axis.text.x = element_text(size = 16),
axis.title.y = element_text(size=16),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black"))
ggplot(para_death, aes(x=daysPupaFoundtoDeath, stat="count"))+
geom_histogram(fill="coral")+
theme(text=element_text(size=15))+
scale_fill_brewer(palette = "Set2")+
labs(title = "Density Plot of Days to Death after Parasitoid Emergence")+
xlab('Days to Death after Parasitoid Emergence')+
ylab('Count')+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",
size = 0.75))
fix_pratt<- prattvilleparasitism %>%
mutate(larvalEmergence=case_when(
larvalEmergence== "0"~ "No parasitoid emerged",
larvalEmergence== "1"~ "Parasitoid emerged")) %>%
mutate(eggs=case_when(
eggs== "y" ~ "Had eggs",
eggs== "n" ~ "Had no eggs")) %>%
filter(!is.na(larvalEmergence))
ggplot(fix_pratt,
aes(x=daystoDeath, fill=larvalEmergence))+
geom_histogram()+
facet_wrap(larvalEmergence~eggs)+
scale_fill_brewer(palette = "Set2")+
labs(x="Days until Death",
y="Frequency",
title = "Days to Death for Parasitoid Emergence and Eggs")+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",
size = 0.75),
legend.position = "none",
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size=12),
axis.title.y = element_text(size=16),
axis.title.x = element_text(size=16),
strip.text = element_text(size=14),
plot.title = element_text(size = 18))
fix_pratt<- prattvilleparasitism %>%
mutate(larvalEmergence=case_when(
larvalEmergence== "0"~ "No parasitoid emerged",
larvalEmergence== "1"~ "Parasitoid emerged")) %>%
mutate(eggs=case_when(
eggs== "y" ~ "Had eggs",
eggs== "n" ~ "Had no eggs")) %>%
filter(!is.na(larvalEmergence))
ggplot(fix_pratt,
aes(x=daystoDeath, fill=larvalEmergence))+
geom_histogram()+
facet_wrap(larvalEmergence~eggs)+
scale_fill_brewer(palette = "Set2")+
labs(x="Days until Death",
y="Frequency",
title = "Days to Death for Parasitoid Emergence and Eggs")+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",
size = 0.75),
legend.position = "none",
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size=12),
axis.title.y = element_text(size=16),
axis.title.x = element_text(size=16),
strip.text = element_text(size=14),
plot.title = element_text(size = 18))
ggplot(prattvilleparasitism %>% filter( eggs=="y" & !is.na(larvalEmergence) & !is.na(eggs)),
aes(x=daystoDeath, fill=larvalEmergence))+
geom_density(alpha=0.7, position = 'identity')+
geom_vline(xintercept = 11.1)+
geom_vline(xintercept = 20.3)+
xlim(0,60)+
scale_fill_brewer(palette = "Set2")+
geom_text(aes(11.1, label="Avg days Emergence", y=.02), angle=0, size=4)+
geom_text(aes(20.3, label="Avg days no Emergence", y=.01), angle=0, size=4)
ggplot(fecundity, aes(x=larvalEmergence, y=clutches, fill=eggs))+
geom_boxplot()+
theme(text=element_text(size=15))+
scale_fill_brewer(palette = "Set2")+
labs(title = "Distribution of Egg Masses Laid",
subtitle = "for Stink Bugs With or Without Evidence of Parasitism")+
xlab('')+
ylab('Number of Egg Masses Laid by Stink Bug')+
scale_x_discrete(labels=c("Produced a Parasitoid", "Did not Produce a Parasitoid"))+
scale_fill_manual(name="Bearing Parasitoid Eggs",labels=c("Yes", "No"), values=c("aquamarine3","coral"))+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",
size = 0.75),
legend.position = c(.3,.8),
axis.text.x = element_text(size = 16),
axis.title.y = element_text(size=16),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black"))
fec_em<-as.data.frame(fec_em)
ggplot() +
geom_pointrange(data=fec_em, aes(y=emmean, x=larvalEmergence, ymin=lower.CL, ymax=upper.CL, color=eggs), size=2, position="jitter")+
theme(text=element_text(size=15))+
scale_color_brewer(palette = "Set2")+
labs(title = "Mean Fecundity",
subtitle = "by Parasitoid Eggs and Parasitoid Emergence")+
xlab(' ')+
ylab('Mean Fecundity')+
scale_x_discrete(labels=c("Produced a Parasitoid", "Did not Produce a Parasitoid"))+
scale_fill_manual(name="Eggs on Host",labels=c("Yes", "No"), values=c("aquamarine3","coral"))+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",size = 0.75),
legend.position = c(.9,.8))
ggplot(prattvilleparasitism %>% filter(!is.na(larvalEmergence) & eggNumber!=0), aes(x=larvalEmergence, color=larvalEmergence, y=eggNumber))+
geom_point(position = "jitter", size=2)+
theme(text=element_text(size=15))+
scale_color_brewer(palette = "Set2")+# at what did egg number affect parasitism?
ylim(1,10)
ggplot(prattvilleparasitism %>% filter(!is.na(larvalEmergence) & eggNumber!=0), aes(x=eggNumber, fill=larvalEmergence))+
geom_histogram(position = "dodge")+
theme(text=element_text(size=15))+
scale_fill_brewer(palette = "Set2")+
xlim(0,15)
ggplot(prattvilleparasitism %>% filter(!is.na(larvalEmergence) & eggNumber!=0), aes(x=larvalEmergence, fill=larvalEmergence, y=eggNumber))+
geom_boxplot()+
theme(text=element_text(size=15))+
scale_fill_brewer(palette = "Set2")+
ylim(1,10)
ggplot(egg_place, aes(x=body_part, y=egg_num))+
geom_col(position = "dodge", fill="aquamarine3")+
theme(text=element_text(size=15))+
theme (axis.text.x = element_text (angle = 45, vjust = 1, hjust=1))+
theme (axis.text.x = element_text (angle = 45, vjust = 1, hjust=1))+
labs(title = "Frequency of Eggs Laid on Each Body Part",
subtitle = "by Parasitoid Emergence")+
xlab('Body Part')+
ylab('Count')+
scale_x_discrete(labels=c("Dorsal Abd", "Dorsal Thor", "Head", "Leg", "Pronotum", "Scutellum", "Ventral Abd", "Ventral Thor", "Wing"))+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",
size = 0.75))+
facet_wrap(~larvalEmergence)
ggplot() +
geom_pointrange(data=em_place, aes(x=body_part, y=emmean, ymin=asymp.LCL, ymax=asymp.UCL), size=2, color="coral")+
theme(text=element_text(size=15))+
theme (axis.text.x = element_text (angle = 45, vjust = 1, hjust=1))+
labs(title = "Mean Eggs Laid on Each Body Part")+
xlab('Body Part')+
ylab('Mean Egg Number Laid on Body Parts')+
scale_x_discrete(labels=c("Dorsal Abd", "Dorsal Thor", "Head", "Leg", "Pronotum", "Scutellum", "Ventral Abd", "Ventral Thor", "Wing"))+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",
size = 0.75))
ggplot(perc_eggem)+
geom_col(aes(x=larvalEmergence, y=count_f, fill=eggs), position = "dodge")+
theme(text=element_text(size=15))+
labs(title = "Proportion of Stink Bugs that Produced a Parasitoid")+
ylab('Number of Stink Bugs')+
scale_fill_manual(name="Bearing Parasitoid Eggs",labels=c("Yes", "No"), values=c("aquamarine3","coral"))+
scale_x_discrete(labels=c("Produced a Parasitoid","Did not Produce a Parasitoid"))+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",
size = 0.75),
legend.position = c(.5,.8),
axis.text.x = element_text(size = 16),
axis.title.y = element_text(size=16),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black"))
ggsave(filename = file.path("Outputs","proportionpara.png"))
ggplot() +
geom_pointrange(data=eggnum_sex_em, aes(y=emmean, x=Sex, ymin=lower.CL, ymax=upper.CL, color=matingpair), size=2, position="jitter")+
theme(text=element_text(size=15))+
scale_color_brewer(palette = "Set2")+
labs(title = "Eggs Laid on Hosts",
subtitle = "by Sex and Mating Pair")+
xlab('Sex of Host')+
ylab('Mean Egg Number Laid on Host')+
scale_x_discrete(labels=c("Male", "Female"))+
scale_fill_manual(name="Mating Pair",labels=c("Yes", "No"), values=c("aquamarine3","coral"))+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",size = 0.75),
legend.position = c(.8,.8))
ggplot() +
geom_pointrange(data=fec_em, aes(y=emmean, x=larvalEmergence, ymin=lower.CL, ymax=upper.CL, color=eggs), size=2, position="jitter")+
theme(text=element_text(size=15))+
scale_color_brewer(palette = "Set2")+
labs(title = "Mean Fecundity",
subtitle = "by Parasitoid Eggs and Parasitoid Emergence")+
xlab(' ')+
ylab('Mean Fecundity')+
scale_x_discrete(labels=c("Produced a Parasitoid", "Did not Produce a Parasitoid"))+
scale_fill_manual(name="Eggs on Host",labels=c("Yes", "No"), values=c("aquamarine3","coral"))+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",size = 0.75),
legend.position = c(.9,.8))
####fecundity ~ laravalemergence ####
fecundity<- prattvilleparasitism %>%
filter(Sex=="f" & !is.na(larvalEmergence)) %>%
mutate(clutches=coalesce(clutches, 0)) %>%
select(larvalEmergence, clutches, eggs)
fecundity
egg_place<-prattvilleparasitism %>%
pivot_longer(cols=scutellum:wing,
names_to="body_part",
values_to="egg_num") %>%
select(body_part, egg_num, eggNumber, Insectnumber, larvalEmergence) %>%
filter(!is.na(egg_num) & !is.na(larvalEmergence)) %>%
rename(total_egg=eggNumber)
egg_place
eggnum_sex<-lm(eggNumber~ Sex*matingpair, prattvilleparasitism %>% filter(Sex!="nymph" & eggs=="y"))
Anova(eggnum_sex)
eggnum_sex_em<-emmeans(eggnum_sex,~ Sex*matingpair)
pairs(eggnum_sex_em)
eggnum_sex_em<-as.data.frame(eggnum_sex_em)
head(eggnum_sex_em)
ggplot() +
geom_pointrange(data=eggnum_sex_em, aes(y=emmean, x=Sex, ymin=lower.CL, ymax=upper.CL, color=matingpair), size=2, position="jitter")+
theme(text=element_text(size=15))+
scale_color_brewer(palette = "Set2")+
labs(title = "Eggs Laid on Hosts",
subtitle = "by Sex and Mating Pair")+
xlab('Sex of Host')+
ylab('Mean Egg Number Laid on Host')+
scale_x_discrete(labels=c("Male", "Female"))+
scale_fill_manual(name="Mating Pair",labels=c("Yes", "No"), values=c("aquamarine3","coral"))+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",size = 0.75),
legend.position = c(.8,.8))
mean_eggnum_sex<- prattvilleparasitism %>%
filter(eggs=="y" & Sex!="nymph") %>%
filter(!is.na(eggNumber)) %>%
group_by(Sex) %>%
summarise(mean_eggnum=mean(eggNumber))
head(mean_eggnum_sex) #avg eggs laid on males is 3.69, avg eggs laid on females is 1.94,
ggtexttable(num_parasitized, rows = NULL, theme = ttheme("classic"),
cols = c("Sex","Parasitoid Eggs","Count")) #table showing this
ggplot(emergence_noNA%>% filter(Sex!="nymph"), aes(fill=Sex, x=larvalEmergence))+
geom_histogram(stat="count", position="dodge") +
theme(text=element_text(size=15))+
scale_fill_brewer(palette = "Set2")+
labs(title = "Emergence of Parasitoid by Sex of Host")+
xlab('Parasitoid Emergence')+
ylab('Count')+
scale_x_discrete(labels=c("Yes", "No"))+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",
size = 0.75),
legend.position = c(.1,.8))
ggplot(clean_death, aes(x=larvalEmergence, y=daystoDeath, fill=larvalEmergence))+
geom_boxplot()+
theme(text=element_text(size=15))+
scale_fill_brewer(palette = "Set2")+
scale_x_discrete(labels=c("Produced a Parasitoid", "Did not Produce a Parasitoid"))+
labs(x=" ",
y="Days until Death",
title = "Days to death and Parasitoid Emergence")
ggplot(clean_death %>% filter(eggNumber<20 & eggNumber>0 & daystoDeath<100),
aes(y=eggNumber, x=daystoDeath, color=larvalEmergence))+
geom_point(size=3, alpha=.7, position = "jitter")+
theme(text=element_text(size=15))+
geom_smooth(method="lm", se=FALSE)+
labs(y="Number of Eggs on Host",
x="Days until Death",
title = "Days until Death in Parasitized Bugs",
subtitle = "by Number of Eggs laid on Host")+
scale_color_manual(name="Produced a Parasitoid", labels=c("Yes","No"),
values = c("aquamarine3","coral"))+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",
size = 0.75),
legend.position = c(.5,.8),
axis.text.x = element_text(size = 16),
axis.title.y = element_text(size=16),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black"),
strip.background = element_blank(),
strip.text = element_blank())+
scale_y_continuous(breaks=seq(0, 12, 2))+
coord_cartesian(ylim=c(0,12))+
facet_wrap(~larvalEmergence)
################################# egg placement ##########################################
#set it up
egg_place<-prattvilleparasitism %>%
pivot_longer(cols=scutellum:wing,
names_to="body_part",
values_to="egg_num") %>%
select(body_part, egg_num, larvalEmergence) %>%
filter(!is.na(egg_num) & !is.na(larvalEmergence))
eggplace<-glm(larvalEmergence~body_part, egg_place, family=binomial(link="cloglog"))
Anova(eggplace)
em_place<-emmeans(eggplace,~body_part)
em_place
plot(em_place)
head(em_place)
em_place<-as.data.frame(em_place)
head(em_place)
egg_place<-prattvilleparasitism %>%
pivot_longer(cols=scutellum:wing,
names_to="body_part",
values_to="egg_num") %>%
select(body_part, egg_num, eggNumber, Insectnumber, larvalEmergence) %>%
filter(!is.na(egg_num) & !is.na(larvalEmergence)) %>%
rename(total_egg=eggNumber)
egg_place
eggnum_sex<-lm(eggNumber~ Sex*matingpair, prattvilleparasitism %>% filter(Sex!="nymph" & eggs=="y"))
Anova(eggnum_sex)
eggnum_sex_em<-emmeans(eggnum_sex,~ Sex*matingpair)
pairs(eggnum_sex_em)
eggnum_sex_em<-as.data.frame(eggnum_sex_em)
head(eggnum_sex_em)
ggplot() +
geom_pointrange(data=eggnum_sex_em, aes(y=emmean, x=Sex, ymin=lower.CL, ymax=upper.CL, color=matingpair), size=2, position="jitter")+
theme(text=element_text(size=15))+
scale_color_brewer(palette = "Set2")+
labs(title = "Eggs Laid on Hosts",
subtitle = "by Sex and Mating Pair")+
xlab('Sex of Host')+
ylab('Mean Egg Number Laid on Host')+
scale_x_discrete(labels=c("Male", "Female"))+
scale_fill_manual(name="Mating Pair",labels=c("Yes", "No"), values=c("aquamarine3","coral"))+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",size = 0.75),
legend.position = c(.8,.8))
ggplot(perc_eggem)+
geom_col(aes(x=larvalEmergence, y=count_f, fill=eggs), position = "dodge")+
theme(text=element_text(size=15))+
labs(title = "Proportion of Stink Bugs that Produced a Parasitoid")+
ylab('Number of Stink Bugs')+
scale_fill_manual(name="Bearing Parasitoid Eggs",labels=c("Yes", "No"), values=c("aquamarine3","coral"))+
scale_x_discrete(labels=c("Produced a Parasitoid","Did not Produce a Parasitoid"))+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",
size = 0.75),
legend.position = c(.5,.8),
axis.text.x = element_text(size = 16),
axis.title.y = element_text(size=16),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black"))
####################### parasitism rates ###################################################
perc_em<-prattvilleparasitism %>%
filter(!is.na(larvalEmergence)) %>%
group_by(larvalEmergence) %>%
summarise(count_f=n())
#creates dataset of count of bugs that produced a parasitoid and those that didn't
perc_em
153/(153+275)
egg_place<-prattvilleparasitism %>%
pivot_longer(cols=scutellum:wing,
names_to="body_part",
values_to="egg_num") %>%
select(body_part, egg_num, eggNumber, Insectnumber, larvalEmergence) %>%
filter(!is.na(egg_num) & !is.na(larvalEmergence)) %>%
rename(total_egg=eggNumber)
egg_place
ggplot() +
geom_pointrange(data=eggnum_sex_em, aes(y=emmean, x=Sex, ymin=lower.CL, ymax=upper.CL, color=matingpair), size=2, position="jitter")+
theme(text=element_text(size=15))+
scale_color_brewer(palette = "Set2")+
labs(title = "Eggs Laid on Hosts",
subtitle = "by Sex and Mating Pair")+
xlab('Sex of Host')+
ylab('Mean Egg Number Laid on Host')+
scale_x_discrete(labels=c("Male", "Female"))+
scale_fill_manual(name="Mating Pair",labels=c("Yes", "No"), values=c("aquamarine3","coral"))+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",size = 0.75),
legend.position = c(.8,.8))
eggnum_sex<-lm(eggNumber~ Sex*matingpair, prattvilleparasitism %>% filter(Sex!="nymph" & eggs=="y"))
Anova(eggnum_sex)
eggnum_sex_em<-as.data.frame(eggnum_sex_em)
head(eggnum_sex_em)
ggplot() +
geom_pointrange(data=eggnum_sex_em, aes(y=emmean, x=Sex, ymin=lower.CL, ymax=upper.CL, color=matingpair), size=2, position="jitter")+
theme(text=element_text(size=15))+
scale_color_brewer(palette = "Set2")+
labs(title = "Eggs Laid on Hosts",
subtitle = "by Sex and Mating Pair")+
xlab('Sex of Host')+
ylab('Mean Egg Number Laid on Host')+
scale_x_discrete(labels=c("Male", "Female"))+
scale_fill_manual(name="Mating Pair",labels=c("Yes", "No"), values=c("aquamarine3","coral"))+
theme(panel.border = element_rect(colour = "black", fill=NA, size=2),
panel.grid = element_line(color = "gray",size = 0.75),
legend.position = c(.8,.8))
egg_place<-prattvilleparasitism %>%
pivot_longer(cols=scutellum:wing,
names_to="body_part",
values_to="egg_num") %>%
select(body_part, egg_num, eggNumber, Insectnumber, larvalEmergence) %>%
filter(!is.na(egg_num) & !is.na(larvalEmergence)) %>%
rename(total_egg=eggNumber)
egg_place
eggnum_sex<-lm(eggNumber~ Sex*matingpair, prattvilleparasitism %>% filter(Sex!="nymph" & eggs=="y"))
Anova(eggnum_sex)
eggnum_sex_em<-as.data.frame(eggnum_sex_em)
head(eggnum_sex_em)
